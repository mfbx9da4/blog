<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
    <head>
    
                <!-- Basic Page Needs
        ================================================== -->
        <meta charset="utf-8">
        <title>WilliamHart.info |  An Ember.js beginners tutorial</title>
        <meta name="description" content="The home page of William Hart - mechanical engineer by day, programmer by night">
        <meta name="author" content="William Hart">
        <meta name="keywords" content="William Hart, williamhart.info, engineering, programming, blog" />
        
        <!-- Mobile Specific Metas
        ================================================== -->
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

        <!-- CSS
        ================================================== -->
                <link rel="stylesheet" href="./theme/css/wh.min.css?d5b9a99a" type="text/css">
                <link href='http://fonts.googleapis.com/css?family=Monda' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'>

        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <!-- Favicons
        ================================================== -->
        <link rel="shortcut icon" href="images/favicon.ico">
        <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
        <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">

                <link href="http://www.williamhart.info/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="William Hart Full RSS Feed" />
                            </head>

    <body>

        <!-- Primary Page Layout
        ================================================== -->

                        <div class="container">
                    

    <div class="two columns alpha">&nbsp;</div>

    <div class="twelve columns">
                <div class="article_meta">
            <h1>An Ember.js beginners tutorial</h1>
            <span class="author-name">By William Hart</span>
        </div>
        
        <blockquote>
<p><strong>Warning</strong> This is a pretty long tutorial! If you just want to see the finished product you can <a href="https://gist.github.com/will-hart/6550313">browse the source code</a> or have a look at a <a href="http://dev.williamhart.info/ember_roller">live demo</a></p>
</blockquote>
<h2>How about we start with some questions</h2>
<h3>What is Ember.js?</h3>
<p>Ember.js is a client side javascript library which has been in development for quite a while. It recently hit the spotlight as the first stable version (1.0.0) was released.  </p>
<p>In a nutshell, Ember helps you create web applications where a lot of the logic runs in the browser and doesn't necessarily require server requests to function.  You may also have heard of it in the same breath as javascript libraries like backbone or angular.  </p>
<p>When the post interacts with things like buttons and text boxes on the browser page, Ember updates the DOM directly and (almost) instantly, showing changes directly to the post without refreshing the page.  If any server requests are required this can be carried out asynchronously in the background.  In effect, Ember takes over the 'application' side of the web, leaving the server to act as an API engine, serving and saving data.</p>
<h3>Why Ember.js?</h3>
<p>There are an increasing number of client side javascript libraries out there, a few of which I mentioned above.  There is also a lot of debate into which one you should use and whether you should even be using one.  Its fair to say that some of the debates I've read recently are a well over the top.</p>
<p>I'm going to avoid this whole issue and simply say that in the past year I've tried a bunch of libraries out there and found that I enjoyed using Ember the most.  It suits my requirements, is relatively easy to use and seems to have a very structured approach to development within the core team.  I think if you want an application which is easy to write and maintain, responds snappily to post input and works using data from a REST API you can do a lot worse than something like Ember.  In no way am I trying to claim its the only way to go! </p>
<p>In the end, I suggest you have a go at Ember to see how it works and see if you like it.  </p>
<h3>How are Ember applications structured?</h3>
<p>Ember.js applications use an <a href="http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">MVC</a> type structure.  In this approach you have </p>
<ul>
<li><strong>Models</strong> which define the data that is used in an application,</li>
<li><strong>Controllers</strong> which modify, query and edit the data and provide post interactions, and</li>
<li><strong>Views</strong> which display the data and capture post actions</li>
</ul>
<p>In addition, Ember uses <em>templates</em> to define how views should look in the browser.</p>
<h2>Today's application</h2>
<p>There are a lot of TODO tutorials out in the wild, and I'm certainly not going to write up another one.  What we're going to build today is something altogether more exciting, something never before seen in the world of introductory tutorials.  Wait for it... today we are going to build a <strong>DICE ROLLER</strong>.</p>
<p>Hopefully our Dice Roller is going to show a couple of the interesting Ember features in an application which does not require a server backend.  </p>
<blockquote>
<p>For consuming REST APIs, Ember has a data backend known as <code>ember-data</code>.  I've never found that this quite matches my requirements so I've always rolled my own.  I am unlikely to spend much time discussing this approach as <a href="http://eviltrout.com/2013/03/23/ember-without-data.html">Evil Trout</a> has already done a pretty good job.</p>
</blockquote>
<p>So our application needs a few features... </p>
<ul>
<li>Input the number of dice and the number of sides into a text box (e.g. 3d6)</li>
<li>"Roll" the dice and record the number of results</li>
<li>Draw a pretty (or otherwise) HTML chart of the results</li>
</ul>
<p>Simple right? Well this is a beginners tutorial after all! :) This means lots of things aren't going to be covered in this tutorial... some of the major Ember features left out are:</p>
<ul>
<li>How to structure the files for a complex or large application</li>
<li>How to use <code>ember-data</code></li>
<li>How to roll your own data access</li>
<li>Anything not covered below :)</li>
</ul>
<p>Despite this I think we are going to cover enough to get somebody new to Ember on the right track.  Enough talk, lets get coding!</p>
<h2>Getting Started</h2>
<h3>Building the HTML</h3>
<p>The first thing that needs to be done is to build an HTML file to serve the application.  For starters, this is just a matter of building a basic HTML document with the jQuery, <a href="http://www.emberjs.com">Ember</a> and <a href="http://handlebarsjs.com/">handlebars</a> scripts included.  Handlebars is a <em>templating</em> language which lets you write out data bound templates that are rendered into the browser.  Create an <code>index.html</code> file and enter the following:</p>
<div class="codehilite"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;title&gt;</span>An Ember dice roller<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>

    <span class="nt">&lt;body&gt;</span>

        <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
        <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;//cdnjs.cloudflare.com/ajax/libs/handlebars.js/1.0.0/handlebars.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
        <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;//cdnjs.cloudflare.com/ajax/libs/ember.js/1.0.0/ember.prod.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>


<p>There shouldn't be anything too exciting here - we are simply setting up a single HTML file with the standard <code>head</code> and <code>body</code> sections and including some scripts.  Its important that the scripts appear in this order; Ember requires jQuery and handlebars and will give you errors if the scripts have not been included before the Ember script.</p>
<blockquote>
<p>If you are running the web page on your hard drive using a <code>file:///</code> url, you may need to put an <code>http:</code> in front of the cdnjs URLs above.</p>
</blockquote>
<h3>Create an application</h3>
<p>So far so good.  Now we need to create and load our Ember application.  Lets start by creating a new file, <code>app.js</code> and including it in our HTML document <strong>below</strong> the other script tags:</p>
<div class="codehilite"><pre><span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;app.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>


<p>Inside <code>app.js</code>, write the following:</p>
<div class="codehilite"><pre><span class="kd">var</span> <span class="nx">Roller</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
    <span class="nx">LOG_TRANSITIONS</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">LOG_BINDINGS</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">LOG_VIEW_LOOKUPS</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">LOG_STACKTRACE_ON_DEPRECATION</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">LOG_VERSION</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">debugMode</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>
</pre></div>


<p>This code creates a brand new application using <code>Ember.Application.create()</code>, calls it <code>Roller</code> and passes it a bunch of variables inside the <code>{}</code>.  These variables are all about debugging information and should probably be set to <code>false</code> for a production application.  However, as we are just getting started with Ember lets leave them on for now as their output is quite useful.</p>
<p>If you open up <code>index.html</code> in your browser and go to the developer console (<code>F12</code> in chrome) you should see some messages on the console:</p>
<div class="codehilite"><pre><span class="n">Could</span> <span class="n">not</span> <span class="nb">find</span> &quot;<span class="n">application</span>&quot; <span class="n">template</span> <span class="n">or</span> <span class="n">view</span><span class="p">.</span> <span class="n">Nothing</span> <span class="n">will</span> <span class="n">be</span> <span class="n">rendered</span> <span class="n">Object</span> <span class="p">{</span><span class="n">fullName</span><span class="p">:</span> &quot;<span class="n">template</span><span class="p">:</span><span class="n">application</span>&quot;<span class="p">}</span>
<span class="n">Could</span> <span class="n">not</span> <span class="nb">find</span> &quot;<span class="n">index</span>&quot; <span class="n">template</span> <span class="n">or</span> <span class="n">view</span><span class="p">.</span> <span class="n">Nothing</span> <span class="n">will</span> <span class="n">be</span> <span class="n">rendered</span> <span class="n">Object</span> <span class="p">{</span><span class="n">fullName</span><span class="p">:</span> &quot;<span class="n">template</span><span class="p">:</span><span class="n">index</span>&quot;<span class="p">}</span>
<span class="n">Transitioned</span> <span class="n">into</span> <span class="s">&#39;index&#39;</span>
</pre></div>


<p>These are debug messages that we asked for in our <code>Application.create</code> call above.  We can see that something is not quite right - Ember can't find a couple of templates or views.  Its not all bad news though, as Ember has <code>transitioned into 'index'</code>.  In this case <code>index</code> refers to a <code>Route</code> which we will talk about more later.</p>
<p>Ok, lets start by fixing some of these log messages.</p>
<h3>The application template</h3>
<p>Ember uses a lot of convention over configuration.  This basically means that when it goes to a URL, it expects a number of objects to exist with very specific names.  If it doesn't find these objects, it can often create default ones.  </p>
<p>In this case when we load our application, Ember looks for a handlebars template called <code>application</code>.  This template is loaded for every url or request and wraps up and displays the entire application.  For now, this template can be quite simple, but when you build a more complex application it can include things like menus, headers and footers.  </p>
<p>Lets write a simple one now.  In the <code>body</code> of your <code>index.html</code> file, above the <code>script</code> tags enter the following:</p>
<div class="codehilite"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/x-handlebars&quot;</span> <span class="na">id=</span><span class="s">&quot;application&quot;</span><span class="nt">&gt;</span>
    <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Dice</span> <span class="nx">Roller</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
    <span class="p">{{</span><span class="nx">outlet</span><span class="p">}}</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>


<p>This looks a lot like HTML, and it basically is.  The important things are that we have specified <code>type="text/x-handlebars"</code> on our script tag, which tells handlebars that it should compile everything inside the script tags as a handlebars template.  Ember then looks for the attribute <code>id="application"</code> and realises that we want this template to be the application template.  </p>
<p>Refreshing the page, you should see that the first log message we saw before should have changed from <code>Could not find "application"</code> to <code>Rendering application with default view</code>, and you should see the heading "Dice Roller" in your browser window.  So we haven't quite removed any log messages but this new message is just Ember saying to us "I see you have an application template, but since you don't have an application view I'm going to make one for you."  No big deal, right?</p>
<blockquote>
<p>When you make changes to Ember applications make sure you refresh the page entirely... sounds obvious but if you click on a link in the Ember application the application itself doesn't get updated from the server.</p>
</blockquote>
<p>The only strange thing in this template is the <code>{{outlet}}</code> written after our heading.  This is a handlebars tag - the curly braces tell handlebars to do something with whatever is inside.  In this case, an <code>outlet</code> is where our application can put other views or templates.  We can see the effect of this by creating another template below the application template in our <code>index.html</code>:</p>
<div class="codehilite"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/x-handlebars&quot;</span> <span class="na">id=</span><span class="s">&quot;index&quot;</span><span class="nt">&gt;</span>
    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>
        <span class="nx">Our</span> <span class="nx">content</span> <span class="nx">goes</span> <span class="nx">here</span>
    <span class="o">&lt;</span><span class="err">/p&gt;</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>


<p>Save and refresh and you should see that below our heading there is now the text "our content goes here".  What has just happened? </p>
<p>This is convention over configuration working overtime.  Ember has loaded up, looked for the default application template and rendered it. It has then checked the URL and realised that its in the <code>index</code> resource (no further URL has been provided - more on this later) and has looked for the <code>index</code> template. Finding it, Ember has put the output from this template into the <code>{{outlet}}</code> of the application template.  Simple, right!?</p>
<h3>Defining URLs (or resources)</h3>
<p>You'll notice that we haven't actually told Ember about any URLs to provide yet... its simply guessed that we want an "index" route when we visit <code>index.html</code> directly and as we haven't defined one, it has generated one for us.  </p>
<p>"But Will," I hear you say, "hardly any applications simply use one URL".  How right you are! Luckily for us, Ember provides a mechanism where complex, nested and dynamic URLs can be provided.  This system is handled by the <a href="http://emberjs.com/guides/routing/"><code>Router</code></a> object.  By default Ember generates an index route, and so no further work is required if we just want a simple resource.  In our case we don't want anything too complex</p>
<blockquote>
<p>In Ember you can think of a resource as kind of like the a "page" in static HTML websites.  </p>
</blockquote>
<p>Configuring a router is dead simple.  At the bottom of your <code>app.js</code> add the following:</p>
<div class="codehilite"><pre><span class="nx">Roller</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> 
    <span class="k">this</span><span class="p">.</span><span class="nx">resource</span><span class="p">(</span><span class="s2">&quot;roll&quot;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<p>Thats it! Refresh your page... errr, nothing has changed.  Well behind the scenes, Ember now knows about our <code>roll</code> URL and if we ask for it will try to find the <code>roll</code> template.  Lets link up this resource in our index view.  Where we previously wrote "Our content goes here" in the index template, replace it with the following:</p>
<div class="codehilite"><pre>{{#linkTo &quot;roll&quot;}}Start rolling dice!{{/linkTo}}
</pre></div>


<p>The curly braces tell us that this is another handlebars "command", but what does it do? Hopefully <code>linkTo</code> is a bit of a give away.  This command generates a link (using an HTML <code>&lt;a&gt;</code> tag to the resource we have called <code>roll</code>, and puts everything between the <code>{{#linkTo ... }}</code> and <code>{{/linkTo}}</code> tags inside the link.  Refresh it and see what happens.</p>
<p>A link appears in the index and we can click it to go to the roll template.  Notice that our address bar now has <code>index.html#/roll</code>.  This is how Ember knows which resource to load.  Everything after the <code>#/</code> is a resource name and we can see here it is <code>roll</code> which we defined in our resources! For more complex or nestted resources you may see a link like <code>index.html#/roll/1/my-roll</code>.  As long as you have correctly configured your <code>Router</code>, Ember will know how to handle this.</p>
<p>You can define custom behaviour for <code>Routes</code> such as <code>roll</code> or <code>index</code> which lets you load specific data or add some complex redirect behaviour (for instance you could check if the post is logged in and if required redirect to a login page).  </p>
<p>In our Dice Roller application at the moment, its silly that posts have to navigate to the application then click on a link to start rolling dice.  Sure, in a real world application we might just merge everything in the roll route into the index route and leave it at that. For the sake of a highly contrived routing example, lets instead <code>redirect</code> any visits to the <code>index</code> route to the <code>roll</code> route.  </p>
<p>Below your <code>Router.map</code> call in the <code>app.js</code> file, add the following:</p>
<div class="codehilite"><pre><span class="nx">Roller</span><span class="p">.</span><span class="nx">IndexRoute</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">redirect</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">transitionTo</span><span class="p">(</span><span class="s2">&quot;roll&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>


<p>The <code>extend</code> part of <code>Ember.Route.extend</code> simply tells Ember we want to create a new version of the pre-defined <code>Ember.Route</code> object and add some of our own logic to it.  This is akin to basic class inheritance in languages such as Python, for instance you may view this as something like:</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">MyNewRouteClass</span><span class="p">(</span><span class="n">Ember</span><span class="o">.</span><span class="n">Route</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;my new route methods follow&quot;&quot;&quot;</span>
</pre></div>


<p>If you remove the <code>#/roll</code> from the URL and refresh, you shoud see that the roll route is automagically navigated to whenever we try to go to the index.  Sweet!  We'll come back to routes a bit later on.</p>
<h3>Add some post controls</h3>
<p>If you looked at the console when we first created our roll <code>linkTo</code> you would have noticed that Ember <code>could not find "roll" template or view</code> which is expected as we haven't defined one.  Lets add one now below the <code>index</code> template in our <code>index.html</code> file.</p>
<div class="codehilite"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/x-handlebars&quot;</span> <span class="na">id=</span><span class="s">&quot;roll&quot;</span><span class="nt">&gt;</span>
    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>
        <span class="nx">Enter</span> <span class="nx">your</span> <span class="nx">required</span> <span class="nx">dice</span> <span class="nx">roll</span> <span class="nx">below</span><span class="p">,</span> <span class="k">for</span> <span class="nx">instance</span> <span class="s2">&quot;3d6&quot;</span> <span class="nx">will</span> <span class="nx">roll</span> <span class="nx">three</span> <span class="nx">six</span> <span class="nx">sided</span> <span class="nx">dice</span><span class="p">.</span>
    <span class="o">&lt;</span><span class="err">/p&gt;</span>

    <span class="p">{{</span><span class="nx">input</span> <span class="nx">valueBinding</span><span class="o">=</span><span class="s2">&quot;rollString&quot;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&quot;Enter your dice roll, e.g. &#39;3d6&#39; here&quot;</span><span class="p">}}</span>

    <span class="o">&lt;</span><span class="nx">hr</span><span class="o">&gt;</span>

    <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">Results</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>

    <span class="p">{{</span><span class="err">#</span><span class="nx">each</span> <span class="nx">roll</span> <span class="k">in</span> <span class="nx">content</span><span class="p">}}</span>
        <span class="nx">I</span> <span class="nx">rolled</span> <span class="nx">a</span> <span class="nx">dice</span> 
    <span class="p">{{</span><span class="k">else</span><span class="p">}}</span>
        <span class="nx">No</span> <span class="nx">results</span> <span class="nx">yet</span>
    <span class="p">{{</span><span class="err">/each}}</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>


<p>There are a few new things here - the <code>{{input}}</code> and <code>{{#each}}</code> tags. </p>
<p>The input tag is a handlebars <code>helper</code> that <a href="http://emberjs.com/guides/templates/input-helpers/">Ember provides</a>.  This renders an input tag of type text with the given placeholder.  It also uses <code>valueBinding</code> to let the controller know that it should ensure that the controller property <code>rollString</code> matches whatever is in the text box at all times.  The HTML code generated by this may look a little like: </p>
<div class="codehilite"><pre><span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;dice_roll&quot;</span> <span class="na">class=</span><span class="s">&quot;ember-view ember-text-field&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Enter your dice roll, e.g. &#39;3d6&#39; here&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span><span class="nt">&gt;</span>
</pre></div>


<p>Great, so what? Well you are right, so far not particularly exciting but stay tuned!  </p>
<p>The <a href="http://handlebarsjs.com/block_helpers.html"><code>{{#each}}</code></a> tag does a <code>forEach</code> on the list or array it is provided.  In other words it does whatever is between the <code>{{#each}}</code> and <code>{{else}}</code> once per object in the given array.  </p>
<p>In this case we have a list of some sort called <code>content</code> and for each item in that list it prints out <code>I rolled a dice</code>.  We can access properties of each of the items in the block by using <code>roll</code>.  We also provide an <code>{{else}}</code> block.  This tells handlebars what to show if there are no items in the <code>content</code> list.</p>
<p>If you refresh the page you will see the input box and text rendered but not much else.  Thats because we haven't hooked up any logic or <em>models</em> to the application yet.  Lets do this now.</p>
<h3>Adding some models</h3>
<p>Our model is going to be very simple, and just define a dice result and a count.  In your <code>app.js</code> file, add the following up near the top, but just after the <code>var Roller</code> declaration:</p>
<div class="codehilite"><pre><span class="nx">Roller</span><span class="p">.</span><span class="nx">Roll</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">diceNumber</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">totalRolls</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">numberOfRolls</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>

    <span class="nx">proportion</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">width</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="mi">400</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;numberOfRolls&quot;</span><span class="p">)</span> <span class="o">/</span> 
            <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;totalRolls&quot;</span><span class="p">));</span>
        <span class="k">return</span> <span class="s2">&quot;width: &quot;</span> <span class="o">+</span> <span class="nx">width</span> <span class="o">+</span> <span class="s2">&quot;px;&quot;</span><span class="p">;</span>
    <span class="p">}.</span><span class="nx">property</span><span class="p">(</span><span class="s2">&quot;totalRolls&quot;</span><span class="p">,</span> <span class="s2">&quot;numberOfRolls&quot;</span><span class="p">)</span>
<span class="p">});</span>
</pre></div>


<p>This is a bit of a javascript mouthful but really quite straight forward.  Once again we are calling <code>extend</code> on something Emberish - here the base <code>Object</code> - and providing some additional information inside the <code>{}</code>.  The first three are simple properties, just some variables that we are storing against this model.  </p>
<p>The last declaration - the <code>proportion</code> property - is a bit more complicated but is where the magic of Ember starts to really show through.  Ember <code>properties</code> are a neat feature that can be used to automatically update the contents of a model when some other attribute changes.  Properties aren't stored in a database, but are <em>derived</em> from other attributes of the model itself.  In this case, we can see that after our function we have written</p>
<div class="codehilite"><pre><span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="s2">&quot;totalRolls&quot;</span><span class="p">,</span> <span class="s2">&quot;numberOfRolls&quot;</span><span class="p">)</span>
</pre></div>


<p>This means that if on a given model the value of either of <code>totalRolls</code> or <code>numberOfRolls</code> changes, then the <code>proportion</code> property will be updated.  Any post interface elements which depend on the <code>proportion</code> property (we'll see how to manage this later) will be automatically updated! </p>
<p>For added confusion we've created a property here that returns a bit of CSS that we will later <code>bind</code> to our DOM element.  In this case it returns a width based on the percentage of total rolls that this dice number represents.  </p>
<blockquote>
<p>The property above uses <code>this.get("variableName");</code> to retrieve properties from the model.  In Ember applications we generally need to use this approach for accessing properties rather than simply <code>this.variableName</code>. </p>
<p>Similarly for setting values we use <code>this.set("variableName", value)</code> instead of <code>this.variableName = value</code></p>
</blockquote>
<h3>Loading models into a route</h3>
<p>By itself, just declaring a model doesn't actually do anything.  We need to tell our route how to gather together the required models.  This is done by <code>extend</code>ing the <code>RollRoute</code> in a similar fashion as we did before when we extended the <code>IndexRoute</code>.  </p>
<p>Below your <code>IndexRoute</code> declaration in <code>app.js</code>, add the following:</p>
<div class="codehilite"><pre><span class="nx">Roller</span><span class="p">.</span><span class="nx">RollRoute</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">model</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="c1">// in a data driven application this could be used </span>
        <span class="c1">// to get information from a server.  Here we just </span>
        <span class="c1">// declare an empty array in memory</span>
        <span class="k">return</span> <span class="p">[];</span>
    <span class="p">},</span>

    <span class="nx">setupController</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">controller</span><span class="p">,</span> <span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">controller</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="nx">model</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>


<p>We provide two additional methods to the <code>RollRoute</code>, firstly <code>model()</code> which retrieves (or in this case generates in memory) some models, and a <code>setupController()</code> method which stores the model information in the controller.  (At the moment our <code>RollController</code> is auto-generated by Ember as we haven't defined one).  </p>
<p>Notice we have used the <code>controller.set()</code> method.  Here Ember calls <code>setupController</code> with a reference to the currently loaded <code>controller</code> - in this case the autogenerated <code>RollController</code> - as well as the model that was loaded using the <code>model()</code> method defined earlier.  The observant amongst you will no doubt notice that in our <code>roll</code> template above we used <code>{{each roll in content}}</code> which should hopefully start to set a few light bulbs glowing! </p>
<p>Refreshing the page again should show that once again nothing above the surface has changed.  Our text box is still sitting there dumbly and we should be seeing a "No results yet" output.  Just for kicks, lets change our <code>model</code> function from returning</p>
<div class="codehilite"><pre><span class="k">return</span> <span class="p">[];</span>
</pre></div>


<p>to returning</p>
<div class="codehilite"><pre><span class="k">return</span> <span class="p">[</span><span class="nx">Roller</span><span class="p">.</span><span class="nx">Roll</span><span class="p">.</span><span class="nx">create</span><span class="p">(),</span> <span class="nx">Roller</span><span class="p">.</span><span class="nx">Roll</span><span class="p">.</span><span class="nx">create</span><span class="p">(),</span> <span class="nx">Roller</span><span class="p">.</span><span class="nx">Roll</span><span class="p">.</span><span class="nx">create</span><span class="p">()];</span>
</pre></div>


<p>Refreshing the page and you should see the output change from "No results yet" to "I rolled a dice I rolled a dice I rolled a dice".  We've used <code>Roller.Roll.create()</code> to create three instances of our model and passed them to the controller in an array.  Ember has then taken the <code>content</code> property we set on the controller and used it in our view.  <strong>Eureka!</strong> </p>
<p>If you get this then you have followed along correctly so far! Ok, quickly change it back before somebody gets blinded by Ember's magnificence.</p>
<h3>Connecting up actions</h3>
<p>In the last section we accomplished something pretty wonderful.  With a few lines of code we set up a route that loads models into memory and displays them in the post interface.  Lets take it one step further now and generate models on the fly based on post input. </p>
<p>Coming to the rescue here are Embers <a href="http://emberjs.com/guides/templates/actions/"><code>actions</code></a>.  These are kind of like event handlers, in that they link up things like click events on buttons or links to functions in your controller.  Ember does also provide a way to directly handle DOM events (such as <code>onClick</code>) in views, we'll cover those right at the end.</p>
<p>To see how this works, we need to actually define a controller.  Firstly, however lets add a little bit to our roll template in <code>index.html</code>.  Replace the current template with the following:</p>
<div class="codehilite"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/x-handlebars&quot;</span> <span class="na">id=</span><span class="s">&quot;roll&quot;</span><span class="nt">&gt;</span>
    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>
        <span class="nx">Enter</span> <span class="nx">your</span> <span class="nx">required</span> <span class="nx">dice</span> <span class="nx">roll</span> <span class="nx">below</span><span class="p">,</span> <span class="k">for</span> <span class="nx">instance</span> <span class="s2">&quot;3d6&quot;</span> <span class="nx">will</span> <span class="nx">roll</span> <span class="nx">three</span> <span class="nx">six</span> <span class="nx">sided</span> <span class="nx">dice</span><span class="p">.</span>
    <span class="o">&lt;</span><span class="err">/p&gt;</span>

    <span class="p">{{</span><span class="nx">input</span> <span class="nx">valueBinding</span><span class="o">=</span><span class="s2">&quot;rollString&quot;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&quot;Enter your dice roll, e.g. &#39;3d6&#39; here&quot;</span><span class="p">}}</span>
    <span class="o">&lt;</span><span class="nx">button</span> <span class="p">{{</span><span class="nx">action</span> <span class="s2">&quot;rollDice&quot;</span><span class="p">}}</span><span class="o">&gt;</span><span class="nx">Roll</span> <span class="nx">Dice</span><span class="o">&lt;</span><span class="err">/button&gt;</span>

    <span class="p">{{</span><span class="err">#</span><span class="k">if</span> <span class="nx">errors</span><span class="p">}}</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;errors&quot;</span><span class="o">&gt;</span>
            <span class="p">{{</span><span class="nx">errors</span><span class="p">}}</span>
        <span class="o">&lt;</span><span class="err">/div&gt;</span>
    <span class="p">{{</span><span class="err">/if}}</span>

    <span class="o">&lt;</span><span class="nx">hr</span><span class="o">&gt;</span>

    <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">Results</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
    <span class="p">{{</span><span class="err">#</span><span class="nx">each</span> <span class="nx">roll</span> <span class="k">in</span> <span class="nx">content</span><span class="p">}}</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;roll&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">span</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;roll-number&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="nx">roll</span><span class="p">.</span><span class="nx">diceNumber</span><span class="p">}}</span><span class="o">&lt;</span><span class="err">/span&gt;</span>
            <span class="o">&lt;</span><span class="nx">span</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;roll-result&quot;</span> <span class="p">{{</span><span class="nx">bindAttr</span> <span class="nx">style</span><span class="o">=</span><span class="s2">&quot;roll.proportion&quot;</span><span class="p">}}</span><span class="o">&gt;</span><span class="p">{{</span><span class="nx">roll</span><span class="p">.</span><span class="nx">numberOfRolls</span><span class="p">}}</span><span class="o">&lt;</span><span class="err">/span&gt;</span>
        <span class="o">&lt;</span><span class="err">/div&gt;</span>
    <span class="p">{{</span><span class="k">else</span><span class="p">}}</span>
        <span class="nx">No</span> <span class="nx">results</span> <span class="nx">yet</span>
    <span class="p">{{</span><span class="err">/each}}</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>


<p>You can see we've used an <code>{{#if}}</code> tag (which does exactly what we would expect) to show errors if any were found - we'll use this in our controller.  We've also improved our output for rolls in the <code>{{#each}}</code> block.  We added a <code>div</code> and two <code>spans</code> to show our values.  </p>
<p>We've also used a tag <code>{{bindAttr ...}}</code>.  This tag lets us bind an attribute of an HTML tag directly to a property of our model.  Here we are using it to set the width of the <code>&lt;span&gt;</code> element based on the <code>proportion</code> property, which is in turn based on the percentage of total rolls this number represents.  Because Ember automatically updates the rendered templates whenever the underlying data changes, if we make changes to <code>content</code> on our controller then the width of this span will update automatically.  Thats neat! </p>
<p>Ok, enough messing about, lets get on to our controller. This will take quite a bit more code so bear with me for a moment or two.  At the bottom of the <code>app.js</code> file, add the following:</p>
<div class="codehilite"><pre><span class="nx">Roller</span><span class="p">.</span><span class="nx">RollController</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">rollDice</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">roll</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;rollString&quot;</span><span class="p">),</span>
            <span class="nx">content</span> <span class="o">=</span> <span class="p">[],</span>
            <span class="nx">rolls</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
            <span class="nx">sides</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">errors</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="nx">i</span><span class="p">,</span> <span class="nx">rnd</span><span class="p">,</span> <span class="nx">roll_parts</span><span class="p">;</span>

        <span class="c1">// check if anything was typed in the text box</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">roll</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="s2">&quot;Please fill out the text box!&quot;</span><span class="p">);</span>
            <span class="k">return</span>
        <span class="p">}</span>

        <span class="c1">// split up the string around the &#39;d&#39; </span>
        <span class="nx">roll_parts</span> <span class="o">=</span> <span class="nx">roll</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">roll_parts</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// check if we had a &quot;d&quot; in our text (i.e. its correctly formatted)</span>
            <span class="nx">errors</span> <span class="o">+=</span> <span class="s2">&quot;You need to enter a value in the format &#39;xdy&#39;.  &quot;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// then split up and parse the required numbers</span>
            <span class="nx">rolls</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">roll_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
            <span class="nx">sides</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">roll_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">rolls</span><span class="p">)</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">sides</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">errors</span> <span class="o">+=</span> <span class="s2">&quot;Rolls and sides must be numbers.  &quot;</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// generate the dice rolls if we haven&#39;t found any errors</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">errors</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// generate all the models</span>
                <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">sides</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">content</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Roller</span><span class="p">.</span><span class="nx">Roll</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
                        <span class="nx">diceNumber</span><span class="o">:</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="nx">totalRolls</span><span class="o">:</span> <span class="nx">rolls</span>
                    <span class="p">}));</span>
                <span class="p">}</span>

                <span class="c1">// now roll all the dice</span>
                <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">rolls</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">// roll a dice</span>
                    <span class="nx">rnd</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sides</span><span class="p">);</span>

                    <span class="c1">// increment the required model</span>
                    <span class="nx">content</span><span class="p">[</span><span class="nx">rnd</span><span class="p">].</span><span class="nx">incrementProperty</span><span class="p">(</span><span class="s2">&quot;numberOfRolls&quot;</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// update the content</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="nx">content</span><span class="p">);</span>

        <span class="c1">// display any errors</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="nx">errors</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>


<p>By now we should be starting to become familiar with Embers <code>extend</code> syntax, but there is a lot more code here than we've seen before.  This is our application's logic, and most of it is to do with error checking.  </p>
<p>I'm not going to go into too much detail as its just plain javascript for the most part, but basically it does the following:</p>
<ol>
<li>Gets the input from the text box and checks it is in the right format</li>
<li>Builds a model for each side of the dice</li>
<li>Randomly rolls dice and <em>increments</em> the <code>numberOfRolls</code> attribute for the correct model by one using the <code>model.incrementProperty('property')</code> method</li>
<li>Sets the <code>content</code> of the controller to our new models and saves any errors encountered</li>
</ol>
<p>Now when you type a valid dice roll into the text box and click the <code>Roll Dice</code> button, you should see some (unformatted) results appearing below.  The key things to note are that we have used <code>this.get()</code> and <code>this.set()</code> to access properties on the controller.  At the end, we have set the <code>content</code> and <code>errors</code> properties on the controller and these are the same <code>content</code> and <code>errors</code> properties we reference in our template.  Similarly, in our template we set the <code>id</code> attribute of our <code>{{input}}</code> to <code>rollString</code> and as a result this is available in our controller using <code>this.get("rollString")</code>.  </p>
<p>You can now refresh the page.  Try typing the following into the text box and see what you get:</p>
<ul>
<li>1</li>
<li>1d</li>
<li>1d6</li>
<li>2da</li>
<li>adb</li>
<li>$#dfgk34j6</li>
<li>ddd</li>
</ul>
<p>Thats it! We now have a fully functioning - if a little plain - dice rolling application using Ember.  By my count we've written about 150 lines of javascript and HTML, which is not too shabby, although we could cut out a bit by merging our roll and index controllers as we discussed above.</p>
<h3>Styling the application</h3>
<p>Until now we have just gone on using the default, ugly HTML styles.  We can easily provide a bit of beauty to our application by just adding a sprinkle of CSS in the usual way.  Into the <code>head</code> tag of your <code>index.html</code>, link up a stylesheet:</p>
<div class="codehilite"><pre><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">href=</span><span class="s">&quot;styles.css&quot;</span><span class="nt">&gt;</span>
</pre></div>


<p>Create <code>styles.css</code> and paste in the following:</p>
<div class="codehilite"><pre><span class="nc">.errors</span> <span class="p">{</span>
    <span class="k">margin</span><span class="o">:</span> <span class="m">2em</span><span class="p">;</span> 
    <span class="k">padding</span><span class="o">:</span> <span class="m">1em</span><span class="p">;</span>
    <span class="k">border</span><span class="o">:</span> <span class="m">1px</span> <span class="k">solid</span> <span class="m">#A22</span><span class="p">;</span>
    <span class="k">color</span><span class="o">:</span> <span class="m">#A22</span><span class="p">;</span>
    <span class="k">background</span><span class="o">:</span> <span class="m">#FDD</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.roll-result</span><span class="o">,</span> <span class="nc">.roll-number</span> <span class="p">{</span>
    <span class="k">display</span><span class="o">:</span> <span class="k">inline</span><span class="o">-</span><span class="k">block</span><span class="p">;</span>
    <span class="k">margin</span><span class="o">:</span> <span class="m">0.2em</span><span class="p">;</span>
    <span class="k">padding</span><span class="o">:</span> <span class="m">0.5em</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.roll-number</span> <span class="p">{</span>
    <span class="k">font-weight</span><span class="o">:</span> <span class="k">bolder</span><span class="p">;</span>
    <span class="k">min-width</span><span class="o">:</span> <span class="m">50px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.roll-result</span> <span class="p">{</span>
    <span class="k">background</span><span class="o">:</span> <span class="m">#03C</span><span class="p">;</span>
    <span class="k">color</span><span class="o">:</span> <span class="nb">white</span><span class="p">;</span>
    <span class="k">text-align</span><span class="o">:</span> <span class="k">right</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">input</span><span class="o">,</span> <span class="nt">button</span> <span class="p">{</span>
    <span class="k">padding</span><span class="o">:</span> <span class="m">0.5em</span><span class="p">;</span>
    <span class="k">font-size</span><span class="o">:</span> <span class="m">1.1em</span><span class="p">;</span>
    <span class="k">border</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span>
    <span class="k">outline</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">input</span> <span class="p">{</span>
    <span class="k">background</span><span class="o">:</span> <span class="m">#EEE</span><span class="p">;</span>
    <span class="k">min-width</span><span class="o">:</span> <span class="m">350px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">button</span> <span class="p">{</span>
    <span class="k">cursor</span><span class="o">:</span><span class="k">pointer</span><span class="p">;</span>
    <span class="k">background</span><span class="o">:</span> <span class="m">#03C</span><span class="p">;</span>
    <span class="k">color</span><span class="o">:</span> <span class="nb">white</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>Now our errors are styled, and when we click "Roll Dice" a nice bar graph will be drawn showing the results.  You should see something like the following:</p>
<p><img alt="Ember.js Dice Roller Screenshot" src="./static/pictures/dice_roller_screenshot.png" /></p>
<h3>Further Improvements</h3>
<p>One annoying "feature" of this application is that when we want to roll some dice we have to click "Roll Dice" every time. It would be much nicer if we could just hit enter when we are happy.  </p>
<p>To do this, lets use a custom view which extends Ember's TextView.  At the very end of our <code>app.js</code> file, insert the following:</p>
<div class="codehilite"><pre><span class="nx">Roller</span><span class="p">.</span><span class="nx">DiceInputField</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">TextField</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">keyDown</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">controller</span><span class="p">,</span> <span class="nx">action</span><span class="p">;</span>

        <span class="c1">// check if we pressed the enter key</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">keyCode</span> <span class="o">!==</span> <span class="mi">13</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// call the controllers &#39;rollDice&#39; function</span>
        <span class="nx">controller</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;controller&quot;</span><span class="p">);</span>
        <span class="nx">action</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;action&quot;</span><span class="p">);</span>
        <span class="nx">controller</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">action</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;rollString&quot;</span><span class="p">),</span> <span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>


<p>This extends the Ember.TextField (which was already being used by the <code>{{input}}</code> tag).  We have also defined a <code>keyDown</code> function, which Ember automatically binds to the <code>keyDown</code> event of the field.  Inside the function it checks whether we have hit the enter key (key code <code>13</code>) and if we have it sends the <code>rollDice</code> action to the controller.</p>
<p>We have to update our template so that it uses this new view.  Simply change the following line:</p>
<div class="codehilite"><pre>{{input valueBinding=&quot;rollString&quot; placeholder=&quot;Enter your dice roll, e.g. &#39;3d6&#39; here&quot;}}
</pre></div>


<p>to </p>
<div class="codehilite"><pre>{{view Roller.DiceInputField valueBinding=&quot;rollString&quot; action=&quot;rollDice&quot; placeholder=&quot;Enter your dice roll, e.g. &#39;3d6&#39; here&quot;}}
</pre></div>


<h3>Conclusion</h3>
<p>Thats it! Hopefully this has given you a fair idea of what is possible in Ember applications.  If you have any comments, corrections or suggestions then feel free to comment below.  Otherwise, get Embering!</p>
        
        <hr class="divider">

        <div class="article_bottom_meta">
                        <span  class="previous_link">
                <a href="editing-markdown-with-emberjs.html"> &lt; &lt; Editing Markdown with Ember.js</a>
            </span>
             |                                     <span class="next_link">
                <a href="c-50-in-a-nutshell.html">C# 5.0 In a Nutshell &gt; &gt;</a>
            </span>
            
            <br>
            Posted: Fri 13 September 2013 by William Hart.  
            <a href="https://twitter.com/share" class="twitter-share-button" data-via="wlhart">Tweet</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
            <br>
                        <p class="center">
                tags:
                <a href="./tag/tutorial.html">tutorial</a>, <a href="./tag/emberjs.html">Ember.js</a>,             </p>
                    </div>
            </div>

    <div class="two columns sidebar-top omega">
        <a class="backlink" href="./index.html">Home</a>
    </div>


            <div class="disqus_container twelve columns alpha omega offset-by-two">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'williamhart'; 

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>            </div><!-- container -->
                
        <!-- Piwik --> 
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://analytics.williamhart.info/" : "http://analytics.williamhart.info/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 3);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://analytics.williamhart.info/piwik.php?idsite=3" style="border:0" alt="" /></p></noscript>
<!-- End Piwik Tracking Code -->
                <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
              tex2jax: {inlineMath: [['!$','$!'],]}
            });
        </script>
        <script type="text/javascript"
          src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        </script>
        
                <!-- End Document
        ================================================== -->
    </body>
</html>